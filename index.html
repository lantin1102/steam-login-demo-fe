<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Login Callback</title>
</head>
<body>
    <h1>Steam Login Callback</h1>
    <div id="message">Processing Steam login...</div>

        <button id="steam-login-button">Login via Steam</button>

    <script>
        document.getElementById('steam-login-button').addEventListener('click', function() {
            // Construct the OpenID login URL
            const openidUrl = 'https://steamcommunity.com/openid/login?' +
                'openid.ns=http://specs.openid.net/auth/2.0' +
                '&openid.mode=checkid_setup' +
                '&openid.return_to=https://xxxx.ngrok.io/callback' +
                '&openid.realm=https://xxxx.ngrok.io' +
                '&openid.identity=http://specs.openid.net/auth/2.0/identifier_select' +
                '&openid.claimed_id=http://specs.openid.net/auth/2.0/identifier_select';
            
            // Redirect the user to Steam's OpenID login page
            window.location.href = openidUrl;
        });
    </script>
    
    <script>
        // 获取URL中的查询参数
        // const queryString = window.location.search;
        // const urlParams = new URLSearchParams(queryString);

        // 提取 Steam 返回的 OpenID 参数
        // const claimedId = urlParams.get('openid.claimed_id');
        // const identity = urlParams.get('openid.identity');
        // const openidMode = urlParams.get('openid.mode');
        // const openidSig = urlParams.get('openid.sig');

        // 检查是否成功获取到用户身份
        // if (openidMode === 'id_res' && claimedId) {
        //     // 提取SteamID
        //     const steamId = claimedId.split('/').pop();
        //     document.getElementById('message').textContent = `Welcome! Your SteamID is: ${steamId}`;
        // } else {
        //     document.getElementById('message').textContent = 'Failed to authenticate with Steam. Please try again.';
        // }

        // 这里可以根据需要将数据发送到你的后端服务进行进一步处理
        // fetch('https://your-backend-server.com/api/verifySteam', {
        //     method: 'POST',
        //     headers: {
        //         'Content-Type': 'application/json'
        //     },
        //     body: JSON.stringify({
        //         claimedId,
        //         openidSig,
        //         otherParams: urlParams.toString()
        //     })
        // }).then(response => response.json())
        //   .then(data => {
        //       console.log('Verification result:', data);
        //   })
        //   .catch(error => console.error('Error verifying Steam user:', error));
    </script>
</body>
</html>
